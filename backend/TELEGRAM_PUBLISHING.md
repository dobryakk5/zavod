# –ü—É–±–ª–∏–∫–∞—Ü–∏—è –≤ Telegram - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Client

–í Django Admin ‚Üí Clients ‚Üí –≤—ã–±–µ—Ä–∏—Ç–µ –∫–ª–∏–µ–Ω—Ç–∞:

- **Telegram API ID** –∏ **API Hash**: –ø–æ–ª—É—á–∏—Ç–µ –Ω–∞ https://my.telegram.org
- **Telegram source channels**: –∫–∞–Ω–∞–ª—ã –¥–ª—è —Å–±–æ—Ä–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: `@rian_ru, @tjournal`)
- **Telegram publish channel**: –æ—Å–Ω–æ–≤–Ω–æ–π –∫–∞–Ω–∞–ª –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### 2. –°–æ–∑–¥–∞–Ω–∏–µ SocialAccount –¥–ª—è Telegram –∫–∞–Ω–∞–ª–æ–≤

–î–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–∞–Ω–∞–ª–æ–≤ —Å–æ–∑–¥–∞–π—Ç–µ SocialAccount:

1. Django Admin ‚Üí Social accounts ‚Üí Add social account
2. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ:
   - **Client**: –≤—ã–±–µ—Ä–∏—Ç–µ –∫–ª–∏–µ–Ω—Ç–∞
   - **Platform**: Telegram
   - **Name**: –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–û—Å–Ω–æ–≤–Ω–æ–π –∫–∞–Ω–∞–ª", "–¢–µ—Å—Ç–æ–≤—ã–π –∫–∞–Ω–∞–ª")
   - **Access token**: –ø–æ–∫–∞ –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –ø—É—Å—Ç—ã–º (–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑ Client)
   - **Extra**: –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å `{"channel": "@my_channel"}` —Å username –∫–∞–Ω–∞–ª–∞

## –ü—É–±–ª–∏–∫–∞—Ü–∏—è –ø–æ—Å—Ç–∞

### –°–ø–æ—Å–æ–± 1: –ß–µ—Ä–µ–∑ Schedule (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. Django Admin ‚Üí Schedules ‚Üí Add schedule
2. **–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ—Å—Ç** - –∫–ª–∏–µ–Ω—Ç –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
3. **–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞–Ω–∞–ª—ã**:
   - **–í–∞—Ä–∏–∞–Ω—Ç –ê**: –û—Ç–º–µ—Ç—å—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–∞–Ω–∞–ª–æ–≤ –≤ —á–µ–∫–±–æ–∫—Å–∞—Ö "Telegram –∫–∞–Ω–∞–ª—ã"
   - **–í–∞—Ä–∏–∞–Ω—Ç –ë**: –í—ã–±–µ—Ä–∏—Ç–µ –æ–¥–∏–Ω –∫–∞–Ω–∞–ª –≤ –ø–æ–ª–µ "Social account"
4. **–£–∫–∞–∂–∏—Ç–µ –≤—Ä–µ–º—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏** –≤ –ø–æ–ª–µ "Scheduled at"
5. **–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ**

–ï—Å–ª–∏ –≤—ã–±—Ä–∞–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–∞–Ω–∞–ª–æ–≤ –≤ —á–µ–∫–±–æ–∫—Å–∞—Ö - —Å–æ–∑–¥–∞—Å—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ Schedule (–ø–æ –æ–¥–Ω–æ–º—É –Ω–∞ –∫–∞–Ω–∞–ª).

### –°–ø–æ—Å–æ–± 2: –ü—É–±–ª–∏–∫–∞—Ü–∏—è "—Å–µ–π—á–∞—Å"

–í —Å–ø–∏—Å–∫–µ Schedules:
1. –í—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—ã–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è (—á–µ–∫–±–æ–∫—Å–∞–º–∏)
2. –í –≤—ã–ø–∞–¥–∞—é—â–µ–º –º–µ–Ω—é –¥–µ–π—Å—Ç–≤–∏–π –≤—ã–±–µ—Ä–∏—Ç–µ **"üì§ –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å —Å–µ–π—á–∞—Å"**
3. –ù–∞–∂–º–∏—Ç–µ "Go"

–ò–ª–∏ –≤ –∫–æ–ª–æ–Ω–∫–µ "–î–µ–π—Å—Ç–≤–∏—è" –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **"üì§ –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å —Å–µ–π—á–∞—Å"** –Ω–∞–ø—Ä–æ—Ç–∏–≤ –Ω—É–∂–Ω–æ–≥–æ –ø–æ—Å—Ç–∞.

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

–ü–æ—Å–ª–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏:
- **Status** –∏–∑–º–µ–Ω–∏—Ç—Å—è –Ω–∞ "Published" (–∏–ª–∏ "Failed" –ø—Ä–∏ –æ—à–∏–±–∫–µ)
- **External ID**: ID —Å–æ–æ–±—â–µ–Ω–∏—è –≤ Telegram
- **Log**: –ª–æ–≥ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ —Å URL –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ—Å—Ç–∞

## –°–±–æ—Ä –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∏–∑ Telegram

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ–º—ã (Topic)

1. Django Admin ‚Üí Topics ‚Üí –≤—ã–±–µ—Ä–∏—Ç–µ —Ç–µ–º—É
2. –í–∫–ª—é—á–∏—Ç–µ —á–µ–∫–±–æ–∫—Å **"Telegram"** –≤ —Å–µ–∫—Ü–∏–∏ "–ò—Å—Ç–æ—á–Ω–∏–∫–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞"
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ Client –∑–∞–ø–æ–ª–Ω–µ–Ω—ã:
   - Telegram API credentials
   - Telegram source channels

### –ó–∞–ø—É—Å–∫ —Å–±–æ—Ä–∞

–í —Å–ø–∏—Å–∫–µ Topics:
1. –í—ã–±–µ—Ä–∏—Ç–µ —Ç–µ–º—É (–∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ)
2. –í –¥–µ–π—Å—Ç–≤–∏—è—Ö –≤—ã–±–µ—Ä–∏—Ç–µ **"üîç –ù–∞–π—Ç–∏ –∫–æ–Ω—Ç–µ–Ω—Ç –∏–∑ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤"**
3. –ù–∞–∂–º–∏—Ç–µ "Go"

–°–∏—Å—Ç–µ–º–∞ –Ω–∞–π–¥–µ—Ç —Ç–æ–ø-5 —Å–∞–º—ã—Ö –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ —É–∫–∞–∑–∞–Ω–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º —Ç–µ–º—ã.

## –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–±–æ—Ä (—á–µ—Ä–µ–∑ Celery Beat)

–î–æ–±–∞–≤—å—Ç–µ –≤ `config/celery.py`:

```python
from celery.schedules import crontab

app.conf.beat_schedule = {
    'discover-content-daily': {
        'task': 'core.tasks.discover_content_for_topic',
        'schedule': crontab(hour=9, minute=0),  # –ö–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 9:00
        'args': (1,),  # ID —Ç–µ–º—ã
    },
}
```

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –ü—É–±–ª–∏–∫–∞—Ü–∏—è –≤ 3 –∫–∞–Ω–∞–ª–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ

1. –°–æ–∑–¥–∞–π—Ç–µ 3 SocialAccount –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤
2. –í Schedule –≤—ã–±–µ—Ä–∏—Ç–µ –ø–æ—Å—Ç –∏ –æ—Ç–º–µ—Ç—å—Ç–µ –≤—Å–µ 3 –∫–∞–Ω–∞–ª–∞ –≤ —á–µ–∫–±–æ–∫—Å–∞—Ö
3. –£–∫–∞–∂–∏—Ç–µ –≤—Ä–µ–º—è –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ
4. –°–æ–∑–¥–∞—Å—Ç—Å—è 3 Schedule, –∫–∞–∂–¥—ã–π –æ–ø—É–±–ª–∏–∫—É–µ—Ç—Å—è –≤ —Å–≤–æ–π –∫–∞–Ω–∞–ª

### –ü—Ä–∏–º–µ—Ä 2: –°–±–æ—Ä –∫–æ–Ω—Ç–µ–Ω—Ç–∞ + –≥–µ–Ω–µ—Ä–∞—Ü–∏—è + –ø—É–±–ª–∏–∫–∞—Ü–∏—è

```python
# –í Django shell –∏–ª–∏ Celery task
from core.tasks import discover_telegram_trends_for_topic, generate_posts_for_topic

# 1. –°–æ–±—Ä–∞—Ç—å —Ç—Ä–µ–Ω–¥—ã –∏–∑ Telegram
discover_telegram_trends_for_topic.delay(topic_id=1)

# 2. –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Å—Ç—ã –∏–∑ —Ç—Ä–µ–Ω–¥–æ–≤
generate_posts_for_topic.delay(topic_id=1)

# 3. –í—Ä—É—á–Ω—É—é —Å–æ–∑–¥–∞—Ç—å Schedule –≤ –∞–¥–º–∏–Ω–∫–µ –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
```

## Troubleshooting

### –û—à–∏–±–∫–∞: "Telegram API credentials –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã"
–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤ Client –∑–∞–ø–æ–ª–Ω–µ–Ω—ã `telegram_api_id` –∏ `telegram_api_hash`.

### –û—à–∏–±–∫–∞: "–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–∞–Ω–∞–ª—É"
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∞–∫–∫–∞—É–Ω—Ç, —á—å–∏ credentials –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è, —è–≤–ª—è–µ—Ç—Å—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º –∫–∞–Ω–∞–ª–∞
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å username –∫–∞–Ω–∞–ª–∞ (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å @)

### –û—à–∏–±–∫–∞: "–ù–µ—Ç Telegram –∫–∞–Ω–∞–ª–æ–≤"
–°–æ–∑–¥–∞–π—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω SocialAccount —Å platform="telegram" –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞.

### –ü—É–±–ª–∏–∫–∞—Ü–∏—è –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Celery worker –∑–∞–ø—É—â–µ–Ω: `celery -A config worker -l info`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ scheduled_at –Ω–µ –≤ –ø—Ä–æ—à–ª–æ–º
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ Schedule.log

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ

### –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ –æ–± –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ

–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–æ–¥–µ–ª—å `SocialAccount` –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—Å–µ–º–∏ –∫–∞–Ω–∞–ª–∞–º–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ (Telegram, Instagram, YouTube). –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:
- –ì–∏–±–∫–æ—Å—Ç—å –≤ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∫–∞–Ω–∞–ª–∞–º–∏ –¥–ª—è –æ–¥–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ Client
